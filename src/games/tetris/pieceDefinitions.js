/**
 * Tetris Piece Definitions
 * Includes all 7 Tetromino types with rotation states, colors, and SRS wall kick data
 */

// Standard Tetris colors following requirements 11.1-11.7
export const PIECE_COLORS = {
  I: '#00f0f0', // Cyan
  O: '#f0f000', // Yellow
  T: '#a000f0', // Purple
  S: '#00f000', // Green
  Z: '#f00000', // Red
  J: '#0000f0', // Blue
  L: '#f0a000'  // Orange
};

// Tetromino shapes - 4x4 matrices for each rotation state
// 1 represents a filled cell, 0 represents empty
export const PIECE_SHAPES = {
  I: [
    // Rotation 0
    [
      [0, 0, 0, 0],
      [1, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 0, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 1, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [0, 0, 0, 0],
      [1, 1, 1, 1],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0]
    ]
  ],
  
  O: [
    // Rotation 0 (all rotations are the same for O-piece)
    [
      [0, 1, 1, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 1, 1, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 1, 1, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [0, 1, 1, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ]
  ],
  
  T: [
    // Rotation 0
    [
      [0, 1, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ]
  ],
  
  S: [
    // Rotation 0
    [
      [0, 1, 1, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [0, 1, 1, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ]
  ],
  
  Z: [
    // Rotation 0
    [
      [1, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 0, 1, 0],
      [0, 1, 1, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [0, 0, 0, 0]
    ]
  ],
  
  J: [
    // Rotation 0
    [
      [1, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 1, 1, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0]
    ]
  ],
  
  L: [
    // Rotation 0
    [
      [0, 0, 1, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 1
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 2
    [
      [0, 0, 0, 0],
      [1, 1, 1, 0],
      [1, 0, 0, 0],
      [0, 0, 0, 0]
    ],
    // Rotation 3
    [
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0]
    ]
  ]
};

// SRS (Super Rotation System) Wall Kick Data
// Format: rotation_from -> rotation_to: [[x, y], ...]
// Offsets are tested in order until a valid position is found

// Wall kick data for J, L, S, T, Z pieces (standard pieces)
export const WALL_KICK_DATA_STANDARD = {
  '0->1': [[0, 0], [-1, 0], [-1, 1], [0, -2], [-1, -2]],
  '1->0': [[0, 0], [1, 0], [1, -1], [0, 2], [1, 2]],
  '1->2': [[0, 0], [1, 0], [1, -1], [0, 2], [1, 2]],
  '2->1': [[0, 0], [-1, 0], [-1, 1], [0, -2], [-1, -2]],
  '2->3': [[0, 0], [1, 0], [1, 1], [0, -2], [1, -2]],
  '3->2': [[0, 0], [-1, 0], [-1, -1], [0, 2], [-1, 2]],
  '3->0': [[0, 0], [-1, 0], [-1, -1], [0, 2], [-1, 2]],
  '0->3': [[0, 0], [1, 0], [1, 1], [0, -2], [1, -2]]
};

// Wall kick data for I-piece (special case)
export const WALL_KICK_DATA_I = {
  '0->1': [[0, 0], [-2, 0], [1, 0], [-2, -1], [1, 2]],
  '1->0': [[0, 0], [2, 0], [-1, 0], [2, 1], [-1, -2]],
  '1->2': [[0, 0], [-1, 0], [2, 0], [-1, 2], [2, -1]],
  '2->1': [[0, 0], [1, 0], [-2, 0], [1, -2], [-2, 1]],
  '2->3': [[0, 0], [2, 0], [-1, 0], [2, 1], [-1, -2]],
  '3->2': [[0, 0], [-2, 0], [1, 0], [-2, -1], [1, 2]],
  '3->0': [[0, 0], [1, 0], [-2, 0], [1, -2], [-2, 1]],
  '0->3': [[0, 0], [-1, 0], [2, 0], [-1, 2], [2, -1]]
};

// O-piece has no wall kicks (requirement 8.5)
export const WALL_KICK_DATA_O = {};

/**
 * Get wall kick data for a specific piece type
 * @param {string} pieceType - The piece type (I, O, T, S, Z, J, L)
 * @returns {Object} Wall kick data for the piece
 */
export function getWallKickData(pieceType) {
  if (pieceType === 'I') {
    return WALL_KICK_DATA_I;
  } else if (pieceType === 'O') {
    return WALL_KICK_DATA_O;
  } else {
    return WALL_KICK_DATA_STANDARD;
  }
}

/**
 * Get the color for a specific piece type
 * @param {string} pieceType - The piece type (I, O, T, S, Z, J, L)
 * @returns {string} CSS color string
 */
export function getPieceColor(pieceType) {
  return PIECE_COLORS[pieceType];
}

/**
 * Get the shape matrix for a specific piece and rotation
 * @param {string} pieceType - The piece type (I, O, T, S, Z, J, L)
 * @param {number} rotation - The rotation state (0-3)
 * @returns {Array<Array<number>>} 4x4 matrix representing the piece shape
 */
export function getPieceShape(pieceType, rotation) {
  return PIECE_SHAPES[pieceType][rotation];
}

/**
 * Get all piece types
 * @returns {Array<string>} Array of all piece type identifiers
 */
export function getAllPieceTypes() {
  return ['I', 'O', 'T', 'S', 'Z', 'J', 'L'];
}

/**
 * Get spawn position for a piece type
 * @param {string} pieceType - The piece type
 * @returns {{x: number, y: number}} Spawn position
 */
export function getSpawnPosition(pieceType) {
  // O-piece spawns at x=4, others at x=3 (requirement 2.1)
  return {
    x: pieceType === 'O' ? 4 : 3,
    y: 0
  };
}
